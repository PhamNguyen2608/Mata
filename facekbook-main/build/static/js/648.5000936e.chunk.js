"use strict";(self.webpackChunkbackbook=self.webpackChunkbackbook||[]).push([[648],{3648:function(e,n,t){t.r(n),t.d(n,{default:function(){return g}});var a=t(885),r=t(2791),s=t(7762),o=t(4165),i=t(5861),c=t(7005),l=t(2388),u=t(7698),d=t.n(u),p=t(7689),h=t(184),m=r.forwardRef((function(e,n){var t=(0,r.useState)({x:0,y:0}),u=(0,a.Z)(t,2),m=u[0],f=u[1],v=(0,r.useState)(1),g=(0,a.Z)(v,2),x=g[0],j=g[1],b=(0,r.useState)(null),y=(0,a.Z)(b,2),N=y[0],w=y[1];console.log("croppedAreaPixels: ",N);var O=(0,r.useState)(!1),C=(0,a.Z)(O,2),Z=C[0],_=C[1],k=(0,r.useState)(!1),S=(0,a.Z)(k,2),P=(S[0],S[1]),I=(0,p.s0)(),F=(0,r.useCallback)((function(e,n){w(n)}),[]),z=function(){var n=(0,i.Z)((0,o.Z)().mark((function n(t){var a,r,s;return(0,o.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,M(e.image);case 2:return a=n.sent,r=document.createElement("canvas"),s=r.getContext("2d"),r.width=t.width,r.height=t.height,s.drawImage(a,t.x,t.y,t.width,t.height,0,0,t.width,t.height),n.abrupt("return",new Promise((function(e,n){r.toBlob((function(t){t?e(t):n(new Error("Kh\xf4ng th\u1ec3 chuy\u1ec3n \u0111\u1ed5i canvas th\xe0nh Blob"))}),"image/png")})));case 9:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),E=function(){var n=(0,i.Z)((0,o.Z)().mark((function n(){var t,r,i,c,u,d,p,h;return(0,o.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return console.log("hi: "),n.next=3,z(N);case 3:t=n.sent,console.log("croppedImageBlob: ",t),r=new File([t],"croppedImage.png",{type:"image/png"}),(i=new FormData).append("user",e.currentUser._id),i.append("image",r),c=(0,s.Z)(i.entries());try{for(c.s();!(u=c.n()).done;)d=(0,a.Z)(u.value,2),p=d[0],h=d[1],console.log(p,h)}catch(o){c.e(o)}finally{c.f()}return n.prev=11,_(!0),n.next=15,l.Z.post("https://mata.onrender.com/api/v1/stories/upload",i,{headers:{"Content-Type":"multipart/form-data"}});case 15:_(!1),P(!0),I("/"),n.next=25;break;case 20:n.prev=20,n.t0=n.catch(11),console.error("L\u1ed7i khi t\u1ea3i h\xecnh \u1ea3nh:",n.t0),console.log("Cropped image as File:",r),_(!1);case 25:console.log("Cropped image as Blob:",t);case 26:case"end":return n.stop()}}),n,null,[[11,20]])})));return function(){return n.apply(this,arguments)}}();(0,r.useImperativeHandle)(n,(function(){return{handleShare:E,addTextToImage:B}}));var M=function(e){return new Promise((function(n,t){var a=new Image;a.src=e,a.onload=function(){return n(a)},a.onerror=function(e){return t(e)}}))},B=function(){};return(0,h.jsxs)("div",{className:"container",children:[Z&&(0,h.jsxs)("div",{children:[(0,h.jsx)("div",{className:"overlay"}),(0,h.jsx)("div",{className:"loading-overlay",children:(0,h.jsx)(d(),{color:"#0C88EF",loading:Z,size:150})})]}),(0,h.jsx)("div",{className:"content",children:(0,h.jsxs)("div",{className:"wrapper",children:[(0,h.jsx)("h1",{className:"title",children:"Xem tr\u01b0\u1edbc"}),(0,h.jsx)("div",{className:"crop-container",children:(0,h.jsx)(c.ZP,{id:"Cropper",image:e.image,crop:m,zoom:x,aspect:9/16,onCropChange:f,onCropComplete:F,onZoomChange:j})}),(0,h.jsx)("div",{className:"controls",children:(0,h.jsx)("input",{type:"range",value:x,min:1,max:3,step:.1,"aria-labelledby":"Zoom",onChange:function(e){j(e.target.value)},className:"zoom-range"})})]})})]})})),f=m,v=t(9434),g=function(e){var n=(0,r.useState)(null),t=(0,a.Z)(n,2),s=t[0],o=t[1],i=(0,r.useState)(!1),c=(0,a.Z)(i,2),l=c[0],u=c[1],d=(0,r.useRef)(),p=(0,v.v9)((function(e){return e.user.userinfo})),m=p.first_name.concat(" ",p.last_name),g=function(){alert("Changes you made may not be saved."),u(!1)};return(0,h.jsxs)("div",{className:"container",children:[(0,h.jsxs)("div",{className:"nav",children:[(0,h.jsxs)("div",{className:"avatar-container",children:[l&&(0,h.jsx)("div",{className:"close-icon",onClick:g}),(0,h.jsx)("h1",{children:"Your Story"}),(0,h.jsxs)("div",{className:"infor",children:[(0,h.jsx)("div",{className:"avatar",children:(0,h.jsx)("img",{src:p.photo,alt:p.photo})}),(0,h.jsx)("span",{className:"name",children:m})]})]}),l&&(0,h.jsxs)("div",{children:[(0,h.jsxs)("div",{className:"button-add",children:[(0,h.jsx)("hr",{className:"horizontalLine"}),(0,h.jsxs)("div",{className:"add",children:[(0,h.jsxs)("div",{className:"iconWrapper",children:[(0,h.jsx)("div",{className:"circle"}),(0,h.jsx)("div",{className:"textIcon",children:"Aa"})]}),(0,h.jsx)("button",{className:"addText",children:"Add text"})]})]}),(0,h.jsx)("div",{className:"submit",children:(0,h.jsx)("button",{className:"my-button",onClick:function(){d.current.handleShare()},children:"Share to story"})})]})]}),l?(0,h.jsx)(f,{image:s,onClose:g,ref:d,currentUser:p}):(0,h.jsx)(h.Fragment,{children:(0,h.jsxs)("div",{className:"upload-container",children:[(0,h.jsx)("input",{type:"file",accept:"image/*",onChange:function(e){var n=e.target.files[0];if(n&&n.type.match(/^image\//)){var t=new FileReader;t.onload=function(e){o(e.target.result),u(!0)},t.readAsDataURL(n)}},style:{display:"none"},id:"imageInput"}),(0,h.jsxs)("label",{htmlFor:"imageInput",className:"upload-button",children:[(0,h.jsxs)("div",{className:"icon-upload",children:[(0,h.jsx)("div",{className:"arrow-up"}),(0,h.jsx)("div",{className:"horizontal-line"})]}),(0,h.jsx)("div",{className:"upload-text",children:"Create Your Story"})]})]})})]})}},7698:function(e,n,t){var a=this&&this.__assign||function(){return a=Object.assign||function(e){for(var n,t=1,a=arguments.length;t<a;t++)for(var r in n=arguments[t])Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r]);return e},a.apply(this,arguments)},r=this&&this.__createBinding||(Object.create?function(e,n,t,a){void 0===a&&(a=t);var r=Object.getOwnPropertyDescriptor(n,t);r&&!("get"in r?!n.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return n[t]}}),Object.defineProperty(e,a,r)}:function(e,n,t,a){void 0===a&&(a=t),e[a]=n[t]}),s=this&&this.__setModuleDefault||(Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var t in e)"default"!==t&&Object.prototype.hasOwnProperty.call(e,t)&&r(n,e,t);return s(n,e),n},i=this&&this.__rest||function(e,n){var t={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&n.indexOf(a)<0&&(t[a]=e[a]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)n.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(t[a[r]]=e[a[r]])}return t};Object.defineProperty(n,"__esModule",{value:!0});var c=o(t(2791)),l=t(8945),u=(0,t(7074).createAnimation)("BounceLoader","0% {transform: scale(0)} 50% {transform: scale(1.0)} 100% {transform: scale(0)}","bounce");n.default=function(e){var n=e.loading,t=void 0===n||n,r=e.color,s=void 0===r?"#000000":r,o=e.speedMultiplier,d=void 0===o?1:o,p=e.cssOverride,h=void 0===p?{}:p,m=e.size,f=void 0===m?60:m,v=i(e,["loading","color","speedMultiplier","cssOverride","size"]),g=function(e){var n=1===e?"".concat(1/d,"s"):"0s";return{position:"absolute",height:(0,l.cssValue)(f),width:(0,l.cssValue)(f),backgroundColor:s,borderRadius:"100%",opacity:.6,top:0,left:0,animationFillMode:"both",animation:"".concat(u," ").concat(2.1/d,"s ").concat(n," infinite ease-in-out")}},x=a({display:"inherit",position:"relative",width:(0,l.cssValue)(f),height:(0,l.cssValue)(f)},h);return t?c.createElement("span",a({style:x},v),c.createElement("span",{style:g(1)}),c.createElement("span",{style:g(2)})):null}}}]);
//# sourceMappingURL=648.5000936e.chunk.js.map