"use strict";(self.webpackChunkbackbook=self.webpackChunkbackbook||[]).push([[178],{6900:function(e,t,s){s.d(t,{Z:function(){return Te}});var n=s(4942),a=s(1413),r=s(885),c=s(2791),i=s(2951),o=s(6431),l=s.n(o),u=s(8561),d=s(3466),m=s(4457),p=s(6821),h=s(2483),_=s(9571),f="ReactsPopup_popup__KVkRv",x="ReactsPopup_react__ccCSh",v=s(184),j=[{name:"like",image:"../../../reacts/like.gif"},{name:"love",image:"../../../reacts/love.gif"},{name:"haha",image:"../../../reacts/haha.gif"},{name:"wow",image:"../../../reacts/wow.gif"},{name:"sad",image:"../../../reacts/sad.gif"},{name:"angry",image:"../../../reacts/angry.gif"}];function g(e){var t=e.handleMouseEnter,s=e.handleMouseLeave,n=e.reactHandler,a=e.setShowReact,r=e.showReact,i=(0,c.useRef)();return(0,_.Z)(i,r,(function(){a(!1)})),(0,v.jsx)("div",{ref:i,className:f,onMouseEnter:t,onMouseLeave:s,children:j.map((function(e,t){return(0,v.jsx)("div",{className:x,onClick:function(){return n(e.name)},children:(0,v.jsx)("img",{src:e.image,alt:e.name})},t)}))})}var Z=s(8272),N=s(4165),C=s(5861),y="CreateComment_wrap__HT+Lg",w="CreateComment_left__dnQRE",k="CreateComment_right__X-fRq",P="CreateComment_input__UAU7Q",S="CreateComment_emoji_picker__GNvu2",b="CreateComment_emoji_wrap__+afoN",R="CreateComment_camera__+rYKE",L="CreateComment_emoji__CtuVk",D="CreateComment_img_perview__cPSdr",F="CreateComment_exit__ADvr-",E=s(833),T=s(3418),M=s(2388),A=s(7956),O=function(){var e=(0,C.Z)((0,N.Z)().mark((function e(t){var s,n,a,r,c,i,o;return(0,N.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=t.form,n=t.post,a=t.type,r="".concat("","/api/v1/posts/AddComment/").concat(n),c="".concat("","/api/v1/posts/comments/").concat(n,"/reply"),e.next=5,M.Z.post("reply"===a?c:r,s,{withCredentials:!0});case 5:return i=e.sent,o=i.data,e.abrupt("return",o);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),U=s(1656),z=s(9434),I=s(5218);var K=function(e){var t=e.commentRef,s=e.post,n=e.commentCountHandler,i=e.setLastCommentData,o=e.placholdertxt,l=e.type,u=e.setReplies,d=e.setCount,m=(0,z.v9)((function(e){return(0,a.Z)({},e.user.userinfo)})),p=(0,c.useState)(null),f=(0,r.Z)(p,2),x=f[0],j=f[1],g=(0,c.useState)(null),M=(0,r.Z)(g,2),K=M[0],H=M[1],Q=(0,c.useState)(!1),q=(0,r.Z)(Q,2),W=q[0],Y=q[1],G=(0,c.useState)(""),B=(0,r.Z)(G,2),V=B[0],J=B[1],X=(0,c.useState)(),$=(0,r.Z)(X,2),ee=($[0],$[1]),te=(0,c.useState)(""),se=(0,r.Z)(te,2),ne=se[0],ae=se[1],re=(0,c.useRef)(),ce=(0,c.useRef)(null);(0,_.Z)(re,W,(function(){Y(!1)}));var ie=(0,Z.D)(x,K,{placement:"top",modifiers:[{name:"offset",options:{offset:[0,10]}}]}),oe=ie.styles,le=ie.attributes,ue=(0,T.D)({mutationKey:"useComment",mutationFn:O,onSuccess:function(e){var t,s=null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.newNotification;s&&A.W.emit("notification",{notification:s})}}),de=ue.mutate,me=ue.data,pe=ue.isSuccess,he=ue.isLoading,_e=ue.isError,fe=ue.error,xe=function(){var e=(0,C.Z)((0,N.Z)().mark((function e(t){var n,a;return(0,N.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),n=new FormData,!V){e.next=7;break}return e.next=5,fetch(V).then((function(e){return e.blob()}));case 5:a=e.sent,n.append("photo",a);case 7:n.append("text",ne),de({form:n,post:s,type:l});case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,c.useEffect)((function(){"success"===(null===me||void 0===me?void 0:me.status)&&(J(""),ae(""),"reply"===l?(u(me.data.replies),d(me.data.replies.length)):(i(me.data.commendData),n(me.data.commentsCount)))}),[me,pe]),(0,c.useEffect)((function(){var e;_e&&I.ZP.error((null===fe||void 0===fe||null===(e=fe.response)||void 0===e?void 0:e.data.message)||"Something went wrong")}),[_e]),(0,v.jsxs)(U.Z,{loading:he,type:2,children:[(0,v.jsxs)("div",{className:y,children:[(0,v.jsx)("div",{className:w,children:(0,v.jsx)("img",{src:m.photo,alt:""})}),(0,v.jsxs)("div",{className:k,children:[(0,v.jsx)("div",{id:"CreateComment",className:P,children:(0,v.jsxs)("form",{className:P,onSubmit:xe,children:[(0,v.jsx)("input",{type:"file",hidden:!0,ref:ce,accept:"image/jpeg,image/png,image/gif,image/webp",onChange:function(e){var t=e.target.files[0];if(("image/jpeg"===t.type||"image/png"===t.type||"image/webp"===t.type||"image/gif"===t.type)&&!(t.size>5242880)){var s=new FileReader;s.readAsDataURL(t),s.onload=function(e){J(e.target.result)}}}}),(0,v.jsx)("input",{placeholder:o,type:"text",ref:t,onChange:function(e){ae(e.target.value)},value:ne})]})}),(0,v.jsxs)("div",{className:b,children:[W?(0,v.jsx)(h.Z,{id:"CreateComment",children:(0,v.jsx)("div",(0,a.Z)((0,a.Z)({className:S,ref:H,style:oe.popper},le.popper),{},{children:(0,v.jsx)("div",{ref:re,children:(0,v.jsx)(E.ZP,{width:300,height:300,lazyLoadEmojis:!0,onEmojiClick:function(e){e.e;var s=e.emoji,n=t.current;n.focus();var a=ne.substring(0,n.selectionStart),r=ne.substring(n.selectionStart);ae(a+s+r),ee(a.length+s.length)},previewConfig:{showPreview:!1},searchDisabled:!0})})}))}):"",(0,v.jsx)("div",{className:R,onClick:function(){return ce.current.click()},children:(0,v.jsx)("i",{className:"camera_icon"})}),(0,v.jsx)("div",{className:L,onClick:function(){Y((function(e){return!e}))},ref:j,children:(0,v.jsx)("i",{className:"emoji_icon_large"})})]})]})]}),V&&(0,v.jsxs)("div",{className:D,children:[(0,v.jsx)("img",{src:V,alt:""}),(0,v.jsx)("div",{className:F,onClick:function(){return J("")},children:(0,v.jsx)("i",{className:"exit_icon"})})]})]})},H=s(4050),Q=function(){var e=(0,C.Z)((0,N.Z)().mark((function e(t){var s,n,a;return(0,N.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=t.post,e.next=3,M.Z.put("".concat("","/api/v1/posts/").concat(s),{},{withCredentials:!0});case 3:return n=e.sent,a=n.data,e.abrupt("return",a);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function q(e){var t=e.icon,s=e.title,n=e.subtitle,a=e.img;return(0,v.jsxs)("li",{className:"hover1",children:[a?(0,v.jsx)("img",{src:a,alt:""}):(0,v.jsx)("i",{className:t}),(0,v.jsxs)("div",{className:i.Z.post_menu_text,children:[(0,v.jsx)("span",{children:s}),n&&(0,v.jsx)("span",{className:i.Z.menu_post_col,children:n})]})]})}var W=s(4802),Y=s(4373),G=s(8029);var B=function(e){var t=e.showMenu,s=e.setShowMenu,n=e.post,a=e.user,r=e.postRef,o=(0,c.useRef)(),l=n.user._id===a._id,u=function(e){return(0,T.D)({mutationKey:["useDeletePost",e],mutationFn:Q})}(n._id),m=u.data,p=u.mutate,h=function(){var e=(0,C.Z)((0,N.Z)().mark((function e(){return(0,N.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,M.Z.post("".concat("","/api/v1/reports/create"),{post:n._id},{withCredentials:!0}).then((function(){I.ZP.success("Report Successfully!"),s(!1)}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),f=function(){var e=(0,C.Z)((0,N.Z)().mark((function e(){return(0,N.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.images.foreach((function(e){var t=e.split("/").pop();(0,W.saveAs)(e,t)})),s(!1);case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,c.useEffect)((function(){"success"===(null===m||void 0===m?void 0:m.status)&&(I.ZP.success("Successfully removed!"),r.current.remove())}),[m,r]),(0,_.Z)(o,t,(function(){s(!1)}));var x="".concat(window.location.origin,"/").concat(n.user.username,"/posts/").concat(n._id);return(0,v.jsx)(d.Z,{className:i.Z.menu,innerRef:o,children:(0,v.jsxs)("ul",{children:[(0,v.jsx)(G.CopyToClipboard,{text:x,onCopy:function(){I.ZP.success("Successfully Copied!"),s(!1)},children:(0,v.jsxs)("li",{className:"hover1",children:[(0,v.jsx)(Y.$PT,{size:22}),(0,v.jsxs)("div",{className:i.Z.post_menu_text,children:[(0,v.jsx)("span",{children:"Copy post link"}),(0,v.jsx)("span",{className:i.Z.menu_post_col,children:"Copy post link to clipboard"})]})]})}),(0,v.jsx)(q,{icon:"save_icon",title:"Save Post",subtitle:"Add this to your saved items."}),n.images.length>0&&(0,v.jsx)("div",{onClick:function(){return f()},children:(0,v.jsx)(q,{icon:"download_icon",title:"Download"})}),l&&(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("div",{className:"line"}),(0,v.jsx)("div",{onClick:function(){p({post:n._id})},children:(0,v.jsx)(q,{icon:"trash_icon",title:"Move to trash",subtitle:"items in your trash are deleted after 30 days"})})]}),!l&&(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("div",{className:"line"}),(0,v.jsx)("div",{onClick:function(){return h()},children:(0,v.jsx)(q,{icon:"trash_icon",title:"Report Post",subtitle:"I'm worried about this post"})})]})]})})},V=s(1087),J=function(){var e=(0,C.Z)((0,N.Z)().mark((function e(t){var s,n,a,r;return(0,N.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=t.post,n=t.type,e.next=3,M.Z.put("".concat("","/api/v1/posts/").concat(s,"/reacts"),{type:n},{withCredentials:!0});case 3:return a=e.sent,r=a.data,e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),X=s(2982),$=s(7858),ee="Comments_comments_wrap__ko11k",te="Comments_info_wrap__bm51H",se="Comments_left__NGTtt",ne="Comments_comment_info__TAKgX",ae="Comments_user__rRelw",re="Comments_comment_info_footer__Nl2Im",ce="Comments_view_more__Yr0zm",ie="Comments_c_time__gOdD1",oe="Comments_img_info__rs0dG",le="Comments_text__rzCoT",ue="Comments_right__pLoOQ",de="Comments_liked__D9ipa",me="Comments_comment_likes__27OsP",pe="Comments_comment__O38mH",he="Comments_tree__usuf-",_e="Comments_tree_line__DD9vD",fe="Comments_comment_user_wrap__E1kjs",xe="Comments_replies_wrap__cCAac",ve=function(){var e=(0,C.Z)((0,N.Z)().mark((function e(t){var s,n,a;return(0,N.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=t.comment,e.next=3,M.Z.put("".concat("","/api/v1/posts/comments/").concat(s,"/like"),{},{withCredentials:!0});case 3:return n=e.sent,a=n.data,e.abrupt("return",a);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),je=s(71);var ge=function(e){var t,s=e.comment,n=(0,z.v9)((function(e){return(0,a.Z)({},e.user.userinfo)})),i=(0,c.useState)(!1),o=(0,r.Z)(i,2),u=o[0],d=o[1],m=(0,c.useState)(s.replies),p=(0,r.Z)(m,2),h=p[0],_=p[1],f=(0,c.useState)(s.likes),x=(0,r.Z)(f,2),j=x[0],g=x[1],Z=(0,c.useState)(0),N=(0,r.Z)(Z,2),C=N[0],y=N[1],w=(0,c.useState)(0),k=(0,r.Z)(w,2),P=k[0],S=k[1],b=(0,c.useRef)(),R=(0,c.useRef)(),L=function(e){return(0,T.D)({mutationKey:["useCommentLike",e],mutationFn:ve,onSuccess:function(e){var t,s=null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.newNotification;s&&A.W.emit("notification",{notification:s})}})}(s._id),D=L.isSuccess,F=L.data,E=L.mutate,M=j.includes(n._id),O=j.length;return(0,c.useEffect)((function(){"success"===(null===F||void 0===F?void 0:F.status)&&g(F.data.likes)}),[D,F]),(0,c.useEffect)((function(){setTimeout((function(){S(R.current.clientHeight)}),50)}),[h,C]),(0,v.jsxs)("div",{className:"".concat(te," ").concat(pe),children:[(0,v.jsx)("div",{className:"".concat(se," ").concat(fe),ref:R,children:(0,v.jsx)("img",{src:s.user.photo,alt:""})}),(0,v.jsxs)("div",{className:ue,children:[(0,v.jsxs)("div",{className:ne,children:[(0,v.jsxs)(V.rU,{to:"/profile/".concat(s.user.username),className:ae,children:["".concat(s.user.first_name," ").concat(s.user.last_name),(null===(t=s.user)||void 0===t?void 0:t.confirmed)&&(0,v.jsx)("i",{style:{marginLeft:"5px"},className:"confirmed_comment_icon"})]}),(0,v.jsx)("div",{className:le,children:s.text}),s.photo&&(0,v.jsx)("div",{className:oe,children:(0,v.jsx)("img",{src:s.photo,alt:s.text})}),O>0&&(0,v.jsxs)("div",{className:me,children:[(0,v.jsx)("img",{src:"../../../reacts/like.svg",alt:""}),(0,v.jsx)("p",{children:O})]})]}),(0,v.jsxs)("div",{className:re,children:[(0,v.jsx)("p",{className:M?de:"",onClick:function(){g(M?j.filter((function(e){return e!==n._id})):[].concat((0,X.Z)(j),[n._id])),E({comment:s._id})},children:"Like"}),(0,v.jsx)("p",{onClick:function(){d(!0),setTimeout((function(){b.current.focus()}),50)},children:"Reply"}),(0,v.jsx)(l(),{fromNow:!0,interval:30,className:ie,children:s.createdAt})]}),(0,v.jsxs)("div",{className:xe,children:[h.slice(0,C).map((function(e,t,s){var n,a=s.length;return(0,v.jsxs)("div",{className:te,children:[(0,v.jsx)("div",{className:se,children:(0,v.jsx)("img",{src:e.user.photo,alt:""})}),(0,v.jsxs)("div",{className:ue,children:[(0,v.jsxs)("div",{className:ne,children:[(0,v.jsxs)(V.rU,{to:"/profile/".concat(e.user.username),className:ae,children:["".concat(e.user.first_name," ").concat(e.user.last_name)," ",(null===(n=e.user)||void 0===n?void 0:n.confirmed)&&(0,v.jsx)("i",{style:{marginLeft:"5px"},className:"confirmed_comment_icon"})]}),(0,v.jsx)("div",{className:le,children:e.text}),e.photo&&(0,v.jsx)("div",{className:oe,children:(0,v.jsx)("img",{src:e.photo,alt:e.text})})]}),(0,v.jsxs)("div",{className:re,children:[(0,v.jsx)("p",{onClick:function(){d(!0),setTimeout((function(){b.current.focus()}),50)},children:"Reply"}),(0,v.jsx)(l(),{fromNow:!0,interval:30,className:ie,children:e.createdAt})]})]}),(0,v.jsx)("div",{className:he,children:t+1===a&&(0,v.jsx)("div",{style:{height:"calc(".concat(P,"px )")},className:_e,children:" "})})]},e._id)})),h.length>C&&(0,v.jsx)(v.Fragment,{children:(0,v.jsx)("div",{className:ce,onClick:function(){y((function(e){return e+3})),d(!0)},children:0===C?(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(je.qQ5,{})," ".concat(h.length," ").concat(1===h.length?"reply":"replies")]}):"( ".concat(h.length-C," ) replies View more replies")})})]}),u&&(0,v.jsx)(K,{placholdertxt:"@".concat(s.user.first_name," ").concat(s.user.last_name," reply ..."),commentRef:b,type:"reply",setReplies:_,setCount:y,post:s._id})]})]})};var Ze=function(e){var t=e.lastComment,s=e.commentsCount,n=e.postID,a=e.lastCommentData,i=e.commentRef,o=(0,c.useState)([]),l=(0,r.Z)(o,2),u=l[0],d=l[1],m=function(){var e=(0,C.Z)((0,N.Z)().mark((function e(t){var s,a,r,c;return(0,N.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=t.pageParam,a=void 0===s?1:s,e.next=3,M.Z.get("".concat("","/api/v1/posts/comments/").concat(n,"?limit=4&page=").concat(a,"&sort=-createdAt"),{withCredentials:!0});case 3:return r=e.sent,c=r.data,e.abrupt("return",c);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),p=(0,$.N)({queryKey:["comments",n],queryFn:m,getNextPageParam:function(e,t){return e.datalength<4?void 0:t.length+1},onSuccess:function(e){var t=e.pages[e.pages.length-1].data.comments;1===e.pages.length?d((0,X.Z)(t)):d((function(e){return[].concat((0,X.Z)(e),(0,X.Z)(t))}))},enabled:!1}),h=p.fetchNextPage,_=p.isFetching;return(0,c.useEffect)((function(){t&&d((function(e){return[].concat((0,X.Z)(e),[t])}))}),[]),(0,c.useEffect)((function(){a&&d((function(e){return[a].concat((0,X.Z)(e))}))}),[a]),(0,v.jsxs)("div",{className:ee,children:[u.map((function(e){return(0,v.jsx)(ge,{comment:e},e._id)})),s>u.length?(0,v.jsx)(v.Fragment,{children:(0,v.jsxs)("div",{className:ce,onClick:function(){h()},children:["View more comments",_&&" Loading..."]})}):(0,v.jsx)(v.Fragment,{children:(0,v.jsx)("div",{className:ce,onClick:function(){i.current.focus()},children:"Write a comment..."})})]})},Ne=s(5439),Ce=s(2579);var ye=function(e){var t=e.showLikes,s=e.setShowLikes,n=e.postID,a=(0,c.useRef)(),o=(0,Ne.a)({queryKey:["getReacts",n],queryFn:function(){var e=(0,C.Z)((0,N.Z)().mark((function e(){var t,s;return(0,N.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,M.Z.get("".concat("","/api/v1/posts/").concat(n,"/reacts/"),{withCredentials:!0});case 2:return t=e.sent,s=t.data,e.abrupt("return",s);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),refetchOnWindowFocus:!1}),l=o.isLoading,u=o.data,m=o.isFetching,p=l||m;return(0,_.Z)(a,t,(function(){s(!1)})),(0,v.jsx)(h.Z,{children:(0,v.jsx)("div",{className:"blur ".concat(i.Z.post_likes),children:(0,v.jsxs)(d.Z,{className:i.Z.post_likes_card,innerRef:a,children:[(0,v.jsxs)("div",{className:i.Z.pheader,children:[(0,v.jsx)("span",{children:"All"}),p&&(0,v.jsx)(Ce.Z,{circle:!0,height:25,width:25,containerClassName:"avatar-skeleton"}),!p&&(null===u||void 0===u?void 0:u.data.stats.types)&&Object.entries(null===u||void 0===u?void 0:u.data.stats.types).map((function(e){var t=(0,r.Z)(e,2),s=t[0],n=t[1];return(0,v.jsxs)("div",{className:i.Z.reacts_info_wrap,children:[(0,v.jsx)("img",{src:"../../../reacts/".concat(s,".svg"),alt:""}),(0,v.jsx)("p",{style:{color:"\n                    ".concat("like"===s?"#029afc":"love"===s?"#f63459":"haha"===s||"sad"===s||"wow"===s?"#f7b125":"angry"===s?"#e4605a":"","\n                ")},children:n.toString()})]},s)})),(0,v.jsx)("div",{className:"".concat(i.Z.exit," small_circle"),children:(0,v.jsx)("i",{onClick:function(){s((function(e){return!e}))},className:"exit_icon"})})]}),(0,v.jsxs)("div",{className:i.Z.likes_content,children:[p&&(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)("div",{className:"".concat(i.Z.react_user," ").concat(i.Z.react_user_wrap),style:{marginTop:"10px"},children:[(0,v.jsx)(Ce.Z,{circle:!0,height:40,width:40,containerClassName:"avatar-skeleton"}),(0,v.jsx)(Ce.Z,{width:150,height:15,style:{transform:"translateY(4px)"}})]}),(0,v.jsxs)("div",{className:"".concat(i.Z.react_user," ").concat(i.Z.react_user_wrap),children:[(0,v.jsx)(Ce.Z,{circle:!0,height:40,width:40,containerClassName:"avatar-skeleton"}),(0,v.jsx)(Ce.Z,{width:150,height:15,style:{transform:"translateY(4px)"}})]})]}),!p&&(null===u||void 0===u?void 0:u.data.reacts)&&(null===u||void 0===u?void 0:u.data.reacts.map((function(e,t){var s;return(0,v.jsxs)(V.rU,{to:"/profile/".concat(e.user.username),className:"".concat(i.Z.react_user," hover3"),children:[(0,v.jsxs)("div",{className:i.Z.react_user_wrap,children:[(0,v.jsx)("img",{className:i.Z.react_user_img,src:e.user.photo,alt:""}),(0,v.jsx)("img",{src:"../../../reacts/".concat(e.type,".svg"),alt:"",className:i.Z.react_icon})]}),(0,v.jsxs)("span",{children:[e.user.first_name," ",e.user.last_name,(null===(s=e.user)||void 0===s?void 0:s.confirmed)&&(0,v.jsx)("i",{style:{marginLeft:"5px",transform:"translateY(2px)"},className:"confirmed_comment_icon"})]})]},e._id)})))]})]})})})};var we=function(e){var t,s,n,a,o=e.post,_=o.images.length,f=(0,c.useState)(0),x=(0,r.Z)(f,2),j=x[0],g=x[1],Z=(0,c.useState)(!1),N=(0,r.Z)(Z,2),C=N[0],y=N[1],w=(0,c.useRef)(),k=o.images,P=(0,c.useCallback)((function(e){g(e),y(!0)}),[]);return(0,c.useEffect)((function(){document.documentElement.style.overflow=C?"hidden":"auto"}),[C]),(0,v.jsxs)(d.Z,{className:i.Z.post,innerRef:w,style:{width:"100%"},children:[(0,v.jsxs)("div",{className:i.Z.body,children:["background"===o.type&&(0,v.jsx)("div",{className:i.Z.background,style:{backgroundImage:"url(".concat(m.h[o.background-1],")"),marginTop:0},children:o.text}),"normal"===o.type&&(0,v.jsx)("div",{className:i.Z.normal,style:{fontSize:"".concat(o.text.length>75?"15px":""),direction:"".concat((0,H.Z)(o.text)?"rtl":"ltr")},children:o.text}),"image"===o.type&&(0,v.jsx)(v.Fragment,{children:(0,v.jsx)("div",{className:"".concat(i.Z.images_wrap," ").concat(2===_?i.Z.per2:3===_?i.Z.per3:4===_?i.Z.per4:5===_?i.Z.per5:""),style:{marginTop:0},children:o.images.map((function(e,t){return(0,v.jsx)("img",{onClick:function(){return P(t)},src:e,alt:t},t)}))})}),"profilePhoto"===o.type&&(0,v.jsx)(v.Fragment,{children:(0,v.jsxs)("div",{className:"".concat(i.Z.profilePhoto_wrap," "),style:{height:"370px"},children:[(0,v.jsx)("div",{className:i.Z.cover,style:{backgroundImage:"url(".concat(o.user.cover,")")}}),(0,v.jsx)("img",{onClick:function(){return P(0)},src:o.images[0],alt:o.text,style:{width:"280px"}})]})}),"cover"===o.type&&(0,v.jsx)(v.Fragment,{children:(0,v.jsx)("div",{className:"".concat(i.Z.images_wrap," "),children:(0,v.jsx)("img",{onClick:function(){return P(0)},src:o.images[0],alt:o.text})})}),(0,v.jsxs)("div",{className:i.Z.header,style:{paddingBottom:"10px"},children:[(0,v.jsx)("div",{className:i.Z.left,children:(0,v.jsx)(V.rU,{to:"/profile/".concat(null===o||void 0===o||null===(t=o.user)||void 0===t?void 0:t.username),children:(0,v.jsx)("img",{src:o.user.photo,alt:"",style:{width:"35px"}})})}),(0,v.jsxs)("div",{className:i.Z.middle,children:[(0,v.jsxs)("div",{children:[(0,v.jsxs)(V.rU,{to:"/profile/".concat(null===o||void 0===o||null===(s=o.user)||void 0===s?void 0:s.username),className:i.Z.username,children:["".concat(o.user.first_name," ").concat(o.user.last_name),(null===(n=o.user)||void 0===n?void 0:n.confirmed)&&(0,v.jsx)("i",{style:{marginLeft:"5px"},className:"confirmed_comment_icon"})]}),"profilePhoto"===o.type?(0,v.jsx)("span",{className:i.Z.profilePhotoText,children:"updated ".concat("male"===o.user.gender?"his":"her"," profile\n                picture")}):"cover"===o.type?(0,v.jsx)("span",{className:i.Z.profilePhotoText,children:"updated ".concat("male"===o.user.gender?"his":"her"," profile\n            cover")}):""]}),(0,v.jsxs)(V.rU,{className:i.Z.date,to:"/".concat(null===o||void 0===o||null===(a=o.user)||void 0===a?void 0:a.username,"/posts/").concat(null===o||void 0===o?void 0:o._id),children:[(0,v.jsx)(l(),{fromNow:!0,interval:30,children:o.createdAt}),(0,v.jsx)(u.Kj,{color:"#828387"})]})]}),(0,v.jsx)("div",{className:i.Z.right})]}),("image"===o.type||"profilePhoto"===o.type)&&(0,v.jsx)("div",{className:i.Z.normal,style:{fontSize:"".concat(o.text.length>40?"15px":""),direction:"".concat((0,H.Z)(o.text)?"rtl":"ltr")},children:o.text})]}),C&&(0,v.jsx)(h.Z,{children:(0,v.jsx)(p.Z,{src:k,currentIndex:j,disableScroll:!1,closeOnClickOutside:!0,onClose:function(){g(0),y(!1)}})})]})},ke=s(6411),Pe="CreateSharePost_wrap__3F5SH",Se="CreateSharePost_card__PAytD",be="CreateSharePost_header__6ohp3",Re="CreateSharePost_content__PLoOo",Le="CreateSharePost_textarea_blue__4fU40",De="CreateSharePost_btns__9Gx7M";var Fe=function(e){var t=e.showSharePost,s=e.setShowSharePost,n=e.post,a=e.setSharesCount,i=(0,c.useState)(""),o=(0,r.Z)(i,2),l=o[0],u=o[1],m=(0,c.useRef)(),p=(0,ke.f)(),f=p.data,x=p.isLoading,j=p.isSuccess,g=p.mutate;return(0,_.Z)(m,t,(function(){s(!1)})),(0,c.useEffect)((function(){var e;j&&"success"===(null===f||void 0===f||null===(e=f.data)||void 0===e?void 0:e.status)&&setTimeout((function(){s(!1),a((function(e){return e+1})),I.ZP.success("Successfully Shared!")}),300)}),[f,j]),(0,v.jsx)(h.Z,{children:(0,v.jsx)("div",{className:"".concat(Pe," blur"),children:(0,v.jsxs)(d.Z,{className:Se,innerRef:m,children:[(0,v.jsxs)("div",{className:be,children:["Share Post",(0,v.jsx)("div",{className:"small_circle",onClick:function(){return s(!1)},children:(0,v.jsx)("i",{className:"exit_icon"})})]}),(0,v.jsx)("div",{className:Re,children:(0,v.jsxs)(U.Z,{loading:x,children:[(0,v.jsx)("textarea",{style:{fontSize:"".concat(l&&l.length>75?"15px":""),direction:"".concat((0,H.Z)(l)?"rtl":"ltr")},placeholder:"Description",value:l,onChange:function(e){return u(e.target.value)},className:Le}),(0,v.jsx)(we,{post:n}),(0,v.jsxs)("div",{className:De,children:[(0,v.jsx)("button",{className:"gray_btn",onClick:function(){return s(!1)},children:"Cancel"}),(0,v.jsx)("button",{className:"btn_blue",onClick:function(){return function(){var e=new FormData;e.append("type","share"),e.append("text",l),e.append("sharedID",n._id),g({data:Object.fromEntries(e),type:"share"})}()},children:"Share"})]})]})})]})})})};var Ee=function(e){var t=e.showMenu,s=e.setShowMenu,n=e.post,a=(e.user,e.postRef,e.setSharesCount),o=(0,c.useRef)(),l=(0,c.useState)(!1),u=(0,r.Z)(l,2),m=u[0],p=u[1];(0,_.Z)(o,t,(function(){m||s(!1)}));var h="".concat(window.location.origin,"/").concat(n.user.username,"/posts/").concat(n._id);return(0,v.jsxs)(d.Z,{className:i.Z.menu,innerRef:o,style:{padding:"10px"},children:[(0,v.jsxs)("ul",{children:[(0,v.jsx)(G.CopyToClipboard,{text:h,onCopy:function(){I.ZP.success("Successfully Copied!"),s(!1)},children:(0,v.jsxs)("li",{className:"hover1",children:[(0,v.jsx)(Y.$PT,{size:22}),(0,v.jsxs)("div",{className:i.Z.post_menu_text,children:[(0,v.jsx)("span",{children:"Copy post link"}),(0,v.jsx)("span",{className:i.Z.menu_post_col,children:"Copy post link to clipboard"})]})]})}),(0,v.jsx)("div",{className:"line"}),(0,v.jsx)("div",{onClick:function(){return p((function(e){return!e}))},children:(0,v.jsx)(q,{icon:"share_icon",title:"Share Post",subtitle:"Share post to your friends"})})]}),m&&(0,v.jsx)(Fe,{showSharePost:m,setShowSharePost:p,post:n,setSharesCount:a})]})};var Te=function(e){var t,s,o,_,f=e.post,x=f.images.length,j=(0,c.useState)(),N=(0,r.Z)(j,2),C=N[0],y=N[1],w=(0,c.useState)(0),k=(0,r.Z)(w,2),P=k[0],S=k[1],b=(0,c.useState)(!1),R=(0,r.Z)(b,2),L=R[0],D=R[1],F=(0,c.useState)(!1),E=(0,r.Z)(F,2),M=E[0],O=E[1],U=(0,c.useState)(!1),I=(0,r.Z)(U,2),Q=I[0],q=I[1],W=(0,c.useState)(!1),Y=(0,r.Z)(W,2),G=Y[0],X=Y[1],$=(0,c.useState)(!1),ee=(0,r.Z)($,2),te=ee[0],se=ee[1],ne=(0,c.useState)(null),ae=(0,r.Z)(ne,2),re=ae[0],ce=ae[1],ie=(0,c.useState)(null),oe=(0,r.Z)(ie,2),le=oe[0],ue=oe[1],de=(0,c.useState)(null),me=(0,r.Z)(de,2),pe=me[0],he=me[1],_e=(0,c.useState)(null),fe=(0,r.Z)(_e,2),xe=fe[0],ve=fe[1],je=(0,c.useState)(null===f||void 0===f?void 0:f.commentsCount),ge=(0,r.Z)(je,2),Ne=ge[0],Ce=ge[1],ke=(0,c.useState)(null===f||void 0===f?void 0:f.sharesCount),Pe=(0,r.Z)(ke,2),Se=Pe[0],be=Pe[1],Re=(0,z.v9)((function(e){return(0,a.Z)({},e.user.userinfo)})),Le=(0,c.useRef)(),De=(0,c.useRef)(),Fe=(0,c.useMemo)((function(){return e=(null===xe||void 0===xe?void 0:xe.types)||{},Object.keys(Object.keys(e).reduce((function(t,s){return e[s]>0&&(t[s]=e[s]),t}),{})).sort((function(t,s){return e[s]-e[t]})).slice(0,3);var e}),[null===xe||void 0===xe?void 0:xe.types]),Te=null===xe||void 0===xe?void 0:xe.isLiked,Me=f.images,Ae=function(e){clearTimeout(pe),he(setTimeout((function(){q(!0)}),800))},Oe=function(){clearTimeout(pe),he(setTimeout((function(){q(!1)}),800))},Ue=(0,Z.D)(re,le,{placement:"top-start",modifiers:[{name:"offset",options:{offset:[0,5]}}]}),ze=Ue.styles,Ie=Ue.attributes,Ke=(0,T.D)({mutationKey:"useReaction",mutationFn:J,onSuccess:function(e){var t,s=null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.newNotification;s&&A.W.emit("notification",{notification:s})}}),He=Ke.mutate,Qe=Ke.data,qe=Ke.isSuccess,We=Ke.isLoading;(0,c.useEffect)((function(){ve(f.reactions)}),[]),(0,c.useEffect)((function(){qe&&ve(Qe.data.reactions)}),[qe,Qe]);var Ye=(0,c.useCallback)((function(e){S(e),D(!0)}),[]);(0,c.useEffect)((function(){document.documentElement.style.overflow=L?"hidden":"auto"}),[L]);var Ge=function(e){Oe(),We||(ve((function(t){return(0,a.Z)((0,a.Z)({},t),{},{isLiked:t.isLiked===e?"":e,totalCount:t.totalCount+(""===t.isLiked?1:t.isLiked!==e?0:-1),types:(0,a.Z)((0,a.Z)({},t.types),{},(0,n.Z)({},e,(t.types[e]||0)+(""===t.isLiked?1:t.isLiked!==e?0:-1)))})})),He({type:e,post:f._id}))};return(0,v.jsxs)(d.Z,{className:i.Z.post,innerRef:Le,children:[(0,v.jsxs)("div",{className:i.Z.header,children:[(0,v.jsx)("div",{className:i.Z.left,children:(0,v.jsx)(V.rU,{to:"/profile/".concat(null===f||void 0===f||null===(t=f.user)||void 0===t?void 0:t.username),children:(0,v.jsx)("img",{src:f.user.photo,alt:""})})}),(0,v.jsxs)("div",{className:i.Z.middle,children:[(0,v.jsxs)("div",{children:[(0,v.jsxs)(V.rU,{to:"/profile/".concat(null===f||void 0===f||null===(s=f.user)||void 0===s?void 0:s.username),className:i.Z.username,children:["".concat(f.user.first_name," ").concat(f.user.last_name),(null===f||void 0===f||null===(o=f.user)||void 0===o?void 0:o.confirmed)&&(0,v.jsx)("i",{style:{marginLeft:"5px",transform:"translateY(2px)"},className:"confirmed_comment_icon"})]}),"profilePhoto"===f.type?(0,v.jsx)("span",{className:i.Z.profilePhotoText,children:"updated ".concat("male"===f.user.gender?"his":"her"," profile\n                picture")}):"cover"===f.type?(0,v.jsx)("span",{className:i.Z.profilePhotoText,children:"updated ".concat("male"===f.user.gender?"his":"her"," profile\n            cover")}):"share"===f.type?(0,v.jsx)("span",{className:i.Z.profilePhotoText,children:"Shared post"}):""]}),(0,v.jsxs)(V.rU,{className:i.Z.date,to:"/".concat(null===f||void 0===f||null===(_=f.user)||void 0===_?void 0:_.username,"/posts/").concat(null===f||void 0===f?void 0:f._id),children:[(0,v.jsx)(l(),{fromNow:!0,interval:30,children:f.createdAt}),(0,v.jsx)(u.Kj,{color:"#828387"})]})]}),(0,v.jsxs)("div",{className:i.Z.right,children:[(0,v.jsx)("div",{onClick:function(){return X((function(e){return!e}))},children:(0,v.jsx)(u.bb,{color:"#828387"})}),G&&(0,v.jsx)(B,{user:Re,showMenu:G,setShowMenu:X,post:f,postRef:Le})]})]}),(0,v.jsxs)("div",{className:i.Z.body,children:["background"===f.type&&(0,v.jsx)("div",{className:i.Z.background,style:{backgroundImage:"url(".concat(m.h[f.background-1],")"),direction:"".concat((0,H.Z)(f.text)?"rtl":"ltr")},children:f.text}),"normal"===f.type&&(0,v.jsx)("div",{className:i.Z.normal,style:{fontSize:"".concat(f.text.length>75?"15px":""),direction:"".concat((0,H.Z)(f.text)?"rtl":"ltr")},children:f.text}),"image"===f.type&&(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("div",{style:{direction:"".concat((0,H.Z)(f.text)?"rtl":"ltr")},className:i.Z.normal,children:f.text}),(0,v.jsx)("div",{className:"".concat(i.Z.images_wrap," ").concat(2===x?i.Z.per2:3===x?i.Z.per3:4===x?i.Z.per4:5===x?i.Z.per5:i.Z.per1),children:f.images.map((function(e,t){return(0,v.jsx)("img",{onClick:function(){return Ye(t)},src:e,alt:t},t)}))})]}),"profilePhoto"===f.type&&(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("div",{className:i.Z.normal,style:{direction:"".concat((0,H.Z)(f.text)?"rtl":"ltr")},children:f.text}),(0,v.jsxs)("div",{className:"".concat(i.Z.profilePhoto_wrap," "),children:[(0,v.jsx)("div",{className:i.Z.cover,style:{backgroundImage:"url(".concat(f.user.cover,")")}}),(0,v.jsx)("img",{onClick:function(){return Ye(0)},src:f.images[0],alt:f.text})]})]}),"cover"===f.type&&(0,v.jsx)(v.Fragment,{children:(0,v.jsx)("div",{className:"".concat(i.Z.images_wrap," "),children:(0,v.jsx)("img",{onClick:function(){return Ye(0)},src:f.images[0],alt:f.text})})}),"share"===f.type&&(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("div",{className:i.Z.normal,style:{fontSize:"".concat(String(f.text).length>20?"15px":""),direction:"".concat((0,H.Z)(f.text)?"rtl":"ltr")},children:f.text}),(0,v.jsx)("div",{className:i.Z.share,children:(0,v.jsx)(we,{post:f.sharedID})})]})]}),(0,v.jsxs)("div",{className:i.Z.footer,children:[(0,v.jsxs)("div",{className:i.Z.infos,children:[(0,v.jsxs)("div",{className:i.Z.left,onClick:function(){return O((function(e){return!e}))},children:[(0,v.jsx)("div",{className:i.Z.reacts_view,children:Fe.map((function(e,t){return(0,v.jsx)("img",{src:"../../../reacts/".concat(e,".svg"),alt:""},t)}))}),(0,v.jsx)("span",{children:(null===xe||void 0===xe?void 0:xe.totalCount)>0&&(null===xe||void 0===xe?void 0:xe.totalCount)})]}),(0,v.jsxs)("div",{className:i.Z.right,children:[(0,v.jsxs)("span",{children:[Ne," comments"]}),(0,v.jsxs)("span",{children:[Se," shares"]})]})]}),(0,v.jsxs)("div",{className:i.Z.actions,children:[Q&&(0,v.jsx)(h.Z,{id:"reactPopper",children:(0,v.jsx)("div",(0,a.Z)((0,a.Z)({ref:ue,style:ze.popper},Ie.popper),{},{children:(0,v.jsx)(g,{reactHandler:Ge,handleMouseEnter:Ae,handleMouseLeave:Oe,setShowReact:q,showReact:Q})}))}),(0,v.jsxs)("div",{className:"".concat(i.Z.action_elment," hover1"),id:"reactPopper",ref:ce,onMouseEnter:Ae,onMouseLeave:Oe,onClick:function(){Oe(),Ge(Te||"like")},onTouchStart:Ae,children:[Te?(0,v.jsx)("img",{src:"../../../reacts/".concat(Te,".svg"),alt:"",className:"small_react",style:{width:"18px"}}):(0,v.jsx)("i",{className:"like_icon"}),(0,v.jsx)("span",{style:{color:"\n                    ".concat("like"===Te?"#029afc":"love"===Te?"#f63459":"haha"===Te||"sad"===Te||"wow"===Te?"#f7b125":"angry"===Te?"#e4605a":"","\n                ")},children:Te||"Like"})]}),(0,v.jsxs)("div",{className:"".concat(i.Z.action_elment," hover1"),onClick:function(){De.current.focus()},children:[(0,v.jsx)("i",{className:"comment_icon"}),(0,v.jsx)("span",{children:"Comment"})]}),"share"===f.type?"":(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)("div",{className:"".concat(i.Z.action_elment," hover1"),onClick:function(){return se((function(e){return!e}))},children:[(0,v.jsx)("i",{className:"share_icon"}),(0,v.jsx)("span",{children:"Share"})]}),te&&(0,v.jsx)(Ee,{user:Re,showMenu:te,setShowMenu:se,post:f,postRef:Le,setSharesCount:be})]})]})]}),(0,v.jsx)("div",{className:i.Z.create_comment,children:(0,v.jsx)(K,{commentCountHandler:function(e){Ce(e)},commentRef:De,setLastCommentData:y,post:f._id,placholdertxt:"Write a comment ..."})}),(0,v.jsx)(Ze,{lastComment:null===f||void 0===f?void 0:f.lastComment[0],commentsCount:null===f||void 0===f?void 0:f.commentsCount,postID:f._id,lastCommentData:C,user:Re,commentRef:De}),L&&(0,v.jsx)(h.Z,{children:(0,v.jsx)(p.Z,{src:Me,currentIndex:P,disableScroll:!1,closeOnClickOutside:!0,onClose:function(){S(0),D(!1)}})}),M&&(0,v.jsx)(ye,{postID:f._id,showLikes:M,setShowLikes:O})]})}},7237:function(e,t,s){s(2791);var n=s(2951),a=s(3466),r=s(2579),c=s(184);t.Z=function(){return(0,c.jsxs)(a.Z,{className:n.Z.post,children:[(0,c.jsxs)("div",{className:n.Z.header,children:[(0,c.jsx)("div",{className:n.Z.left,children:(0,c.jsx)(r.Z,{circle:!0,height:40,width:40,containerClassName:"avatar-skeleton"})}),(0,c.jsxs)("div",{className:n.Z.middle,children:[(0,c.jsx)(r.Z,{width:150,height:15,style:{transform:"translateY(4px)"}}),(0,c.jsx)(r.Z,{width:80,height:8})]})]}),(0,c.jsxs)("div",{className:n.Z.body,style:{padding:"10px"},children:[(0,c.jsx)(r.Z,{count:3,height:18,width:"100%"}),(0,c.jsx)(r.Z,{count:2,height:10,width:"100%"})]})]})}},2951:function(e,t){t.Z={post:"Post_post__1bpwZ",header:"Post_header__wkNpB",left:"Post_left__WOzvM",middle:"Post_middle__Me2N5",username:"Post_username__l7Naw",date:"Post_date__7Hj-B",right:"Post_right__CpbZf",background:"Post_background__LWmqM",normal:"Post_normal__7QMz3",images_wrap:"Post_images_wrap__MHKjs",per1:"Post_per1__977iP",per2:"Post_per2__ds-Ub",per3:"Post_per3__uYzc3",per4:"Post_per4__GdwzO",per5:"Post_per5__QlgEP",footer:"Post_footer__MAWvO",infos:"Post_infos__1-0eR",actions:"Post_actions__r+iBJ",action_elment:"Post_action_elment__ItCU-",menu:"Post_menu__ecUwn",post_menu_text:"Post_post_menu_text__qf+Fz",menu_post_col:"Post_menu_post_col__AlZVE",profilePhotoText:"Post_profilePhotoText__yAcDP",profilePhoto_wrap:"Post_profilePhoto_wrap__ug2ee",cover:"Post_cover__5xLlg",reacts_view:"Post_reacts_view__ErLEm",create_comment:"Post_create_comment__8hOGQ",post_likes:"Post_post_likes__J5DbT",post_likes_card:"Post_post_likes_card__QCrqn",pheader:"Post_pheader__vPdOw",exit:"Post_exit__EBp7F",react_user:"Post_react_user__95wrs",react_user_img:"Post_react_user_img__FfRRA",react_user_wrap:"Post_react_user_wrap__yKF0F",react_icon:"Post_react_icon__+HOmY",reacts_info_wrap:"Post_reacts_info_wrap__GudQB",share:"Post_share__+vvCj",share_content:"Post_share_content__9K351",likes_content:"Post_likes_content__FQ0tA",post_body:"Post_post_body__4Vf7p",createPost_icon:"Post_createPost_icon__2UkIg"}}}]);
//# sourceMappingURL=178.36092f73.chunk.js.map